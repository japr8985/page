import{O as E,P as W,H as A,z as S,N as q,Q as re,R as oe,S as _,F as U,r as L,c as M,T as X,U as z,V as se,W as ue,X as ce,Y as ie,Z as de,$ as ve,a0 as O,o as fe,_ as me,L as he,A as ge,t as pe,B as Se,y as Ve}from"./entry.pWU9ejTJ.js";import{m as Q,u as Y,a as ye,b as Te}from"./dimensions.PJRCoCi9.js";import{u as Z}from"./resizeObserver.yKoS21x9.js";import{g as _e}from"./getScrollParent.hBWoeeaY.js";const Re=E({renderless:Boolean,...Q()},"VVirtualScrollItem"),we=W()({name:"VVirtualScrollItem",inheritAttrs:!1,props:Re(),emits:{"update:height":l=>!0},setup(l,a){let{attrs:u,emit:o,slots:t}=a;const{resizeRef:n,contentRect:d}=Z(void 0,"border");A(()=>{var c;return(c=d.value)==null?void 0:c.height},c=>{c!=null&&o("update:height",c)}),Y(()=>{var c,s;return l.renderless?S(q,null,[(c=t.default)==null?void 0:c.call(t,{itemRef:n})]):S("div",re({ref:n,class:["v-virtual-scroll__item",l.class],style:l.style},u),[(s=t.default)==null?void 0:s.call(t)])})}}),Ie=-1,xe=1,D=100,Pe=E({itemHeight:{type:[Number,String],default:null},height:[Number,String]},"virtual");function be(l,a){const u=oe(),o=_(0);U(()=>{o.value=parseFloat(l.itemHeight||0)});const t=_(0),n=_(Math.ceil((parseInt(l.height)||u.height.value)/(o.value||16))||1),d=_(0),c=_(0),s=L(),g=L();let R=0;const{resizeRef:x,contentRect:P}=Z();U(()=>{x.value=s.value});const T=M(()=>{var e;return s.value===document.documentElement?u.height.value:((e=P.value)==null?void 0:e.height)||parseInt(l.height)||0}),V=M(()=>!!(s.value&&g.value&&T.value&&o.value));let v=Array.from({length:a.value.length}),i=Array.from({length:a.value.length});const m=_(0);let y=-1;function $(e){return v[e]||o.value}const b=se(()=>{const e=performance.now();i[0]=0;const r=a.value.length;for(let f=1;f<=r-1;f++)i[f]=(i[f-1]||0)+$(f-1);m.value=Math.max(m.value,performance.now()-e)},m),j=A(V,e=>{e&&(j(),R=g.value.offsetTop,b.immediate(),w(),~y&&ue(()=>{ce&&window.requestAnimationFrame(()=>{C(y),y=-1})}))});A(T,(e,r)=>{r&&w()}),X(()=>{b.clear()});function G(e,r){const f=v[e],h=o.value;o.value=h?Math.min(o.value,r):r,(f!==r||h!==o.value)&&(v[e]=r,b())}function p(e){return e=z(e,0,a.value.length-1),i[e]||0}function H(e){return ke(i,e)}let k=0,B=0,F=0;function J(){if(!s.value||!g.value)return;const e=s.value.scrollTop,r=performance.now();r-F>500?(B=Math.sign(e-k),R=g.value.offsetTop):B=e-k,k=e,F=r,w()}function K(){!s.value||!g.value||(B=0,F=0,w())}let N=-1;function w(){cancelAnimationFrame(N),N=requestAnimationFrame(ee)}function ee(){if(!s.value||!T.value)return;const e=k-R,r=Math.sign(B),f=Math.max(0,e-D),h=z(H(f),0,a.value.length),le=e+T.value+D,I=z(H(le)+1,h+1,a.value.length);if((r!==Ie||h<t.value)&&(r!==xe||I>n.value)){const ae=p(t.value)-p(h),ne=p(I)-p(n.value);Math.max(ae,ne)>D?(t.value=h,n.value=I):(h<=0&&(t.value=h),I>=a.value.length&&(n.value=I))}d.value=p(t.value),c.value=p(a.value.length)-p(n.value)}function C(e){const r=p(e);!s.value||e&&!r?y=e:s.value.scrollTop=r}const te=M(()=>a.value.slice(t.value,n.value).map((e,r)=>({raw:e,index:r+t.value})));return A(a,()=>{v=Array.from({length:a.value.length}),i=Array.from({length:a.value.length}),b.immediate(),w()},{deep:!0}),{containerRef:s,markerRef:g,computedItems:te,paddingTop:d,paddingBottom:c,scrollToIndex:C,handleScroll:J,handleScrollend:K,handleItemResize:G}}function ke(l,a){let u=l.length-1,o=0,t=0,n=null,d=-1;if(l[u]<a)return u;for(;o<=u;)if(t=o+u>>1,n=l[t],n>a)u=t-1;else if(n<a)d=t,o=t+1;else return n===a?t:o;return d}const Be=E({items:{type:Array,default:()=>[]},renderless:Boolean,...Pe(),...Q(),...ye()},"VVirtualScroll"),Oe=W()({name:"VVirtualScroll",props:Be(),setup(l,a){let{slots:u}=a;const o=ie("VVirtualScroll"),{dimensionStyles:t}=Te(l),{containerRef:n,markerRef:d,handleScroll:c,handleScrollend:s,handleItemResize:g,scrollToIndex:R,paddingTop:x,paddingBottom:P,computedItems:T}=be(l,de(l,"items"));return ve(()=>l.renderless,()=>{function V(){var m,y;const i=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?"addEventListener":"removeEventListener";n.value===document.documentElement?(document[i]("scroll",c,{passive:!0}),document[i]("scrollend",s)):((m=n.value)==null||m[i]("scroll",c,{passive:!0}),(y=n.value)==null||y[i]("scrollend",s))}fe(()=>{n.value=_e(o.vnode.el,!0),V(!0)}),X(V)}),Y(()=>{const V=T.value.map(v=>S(we,{key:v.index,renderless:l.renderless,"onUpdate:height":i=>g(v.index,i)},{default:i=>{var m;return(m=u.default)==null?void 0:m.call(u,{item:v.raw,index:v.index,...i})}}));return l.renderless?S(q,null,[S("div",{ref:d,class:"v-virtual-scroll__spacer",style:{paddingTop:O(x.value)}},null),V,S("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:O(P.value)}},null)]):S("div",{ref:n,class:["v-virtual-scroll",l.class],onScrollPassive:c,onScrollend:s,style:[t.value,l.style]},[S("div",{ref:d,class:"v-virtual-scroll__container",style:{paddingTop:O(x.value),paddingBottom:O(P.value)}},[V])])}),{scrollToIndex:R}}}),Ae={};function Fe(l,a){return pe(),he(Oe,{items:[1,2,3]},{default:ge(({item:u})=>[Se(Ve(u),1)]),_:1})}const Ne=me(Ae,[["render",Fe]]);export{Ne as default};
